<!-- VOICE WIDGET CSS -->
<link rel="stylesheet" href="/assets/css/voice-widget.css">

<!-- VOICE WIDGET ROOT -->
<div id="voice-widget-root" style="z-index: 999999 !important;"></div>

<!-- AOS LIBRARY -->
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

<!-- EFECTOS MEJORADOS -->
<style>
  /* PARALLAX BACKGROUND M√ÅS VISIBLE */
  body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(36, 54, 89, 0.3) 0%, rgba(227, 5, 18, 0.3) 100%);
    background-size: 400% 400%;
    animation: gradientShift 10s ease infinite;
    z-index: 0;
    pointer-events: none;
  }

  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* SCROLL PROGRESS BAR */
  #scroll-progress-bar {
    position: fixed;
    top: 0;
    left: 0;
    width: 0%;
    height: 4px;
    background: linear-gradient(90deg, #243659, #e30512);
    z-index: 999998;
    transition: width 0.1s ease;
    box-shadow: 0 2px 10px rgba(227, 5, 18, 0.5);
  }

  /* HOVER EFFECTS MEJORADOS */
  a:not([class*="voice-widget"]):hover,
  button:not([class*="voice-widget"]):hover {
    transform: translateY(-3px) scale(1.05) !important;
    box-shadow: 0 15px 30px rgba(227, 5, 18, 0.3) !important;
    filter: brightness(1.1);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
  }

  /* CARDS CON EFECTO SHIMMER */
  [class*="card"]:not([class*="voice-widget"]),
  [class*="box"]:not([class*="voice-widget"]),
  [class*="item"]:not([class*="voice-widget"]) {
    position: relative;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  [class*="card"]:not([class*="voice-widget"])::before,
  [class*="box"]:not([class*="voice-widget"])::before,
  [class*="item"]:not([class*="voice-widget"])::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(227, 5, 18, 0.1), transparent);
    animation: shimmer 3s ease-in-out infinite;
    z-index: 1;
    pointer-events: none;
  }

  @keyframes shimmer {
    0% { left: -100%; }
    100% { left: 100%; }
  }

  [class*="card"]:not([class*="voice-widget"]):hover,
  [class*="box"]:not([class*="voice-widget"]):hover,
  [class*="item"]:not([class*="voice-widget"]):hover {
    transform: translateY(-10px) scale(1.03);
    box-shadow: 0 20px 50px rgba(227, 5, 18, 0.25);
  }

  /* RIPPLE EFFECT EN BOTONES */
  button:not([class*="voice-widget"]) {
    position: relative;
    overflow: hidden;
  }

  button:not([class*="voice-widget"]):active::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    animation: ripple 0.6s ease-out;
  }

  @keyframes ripple {
    to {
      width: 300%;
      height: 300%;
      opacity: 0;
    }
  }

  /* TEXT SHINE EFFECT */
  h1, h2, h3 {
    background: linear-gradient(135deg, #243659, #e30512, #243659);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: textShine 5s ease infinite;
  }

  @keyframes textShine {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }

  /* SMOOTH SCROLL */
  html {
    scroll-behavior: smooth;
  }

  /* VOICE WIDGET SIEMPRE VISIBLE */
  #voice-widget-root,
  #voice-widget-root * {
    z-index: 999999 !important;
  }

  .voice-widget-fab {
    z-index: 999999 !important;
    position: fixed !important;
    bottom: 30px !important;
    right: 30px !important;
  }

  .voice-widget-panel {
    z-index: 999999 !important;
  }
</style>

<!-- SCROLL PROGRESS BAR ELEMENT -->
<div id="scroll-progress-bar"></div>

<!-- VOICE WIDGET & EFFECTS SCRIPT -->
<script type="module">
  console.log('üéØ Inicializando efectos y widget...');

  // Import Voice Widget
  import('/src/voice-widget/main.js').then(() => {
    console.log('‚úÖ Voice widget cargado');
    
    // Verificar que el bot√≥n se cre√≥
    setTimeout(() => {
      const fab = document.querySelector('.voice-widget-fab');
      if (fab) {
        console.log('‚úÖ Bot√≥n FAB encontrado');
        fab.style.zIndex = '999999';
        fab.style.position = 'fixed';
      } else {
        console.error('‚ùå Bot√≥n FAB NO encontrado');
      }
    }, 2000);
  }).catch(err => {
    console.error('‚ùå Error cargando widget:', err);
  });

  // Wait for page load
  window.addEventListener('DOMContentLoaded', () => {
    console.log('üìÑ DOM cargado, iniciando efectos...');
    
    // Initialize AOS
    if (typeof AOS !== 'undefined') {
      AOS.init({
        duration: 1000,
        easing: 'ease-in-out-cubic',
        once: false,
        mirror: true,
        offset: 120,
        delay: 100
      });
      console.log('‚úÖ AOS inicializado');
    }

    // Scroll Progress Bar
    const progressBar = document.getElementById('scroll-progress-bar');
    if (progressBar) {
      window.addEventListener('scroll', () => {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        const scrollPercentage = (scrollTop / scrollHeight) * 100;
        progressBar.style.width = scrollPercentage + '%';
      });
      console.log('‚úÖ Scroll progress bar activo');
    }

    // Parallax on Mouse Move
    let parallaxBg = document.querySelector('body::after');
    document.addEventListener('mousemove', (e) => {
      const moveX = (e.clientX - window.innerWidth / 2) * 0.02;
      const moveY = (e.clientY - window.innerHeight / 2) * 0.02;
      document.body.style.backgroundPosition = `${moveX}px ${moveY}px`;
    });
    console.log('‚úÖ Parallax mouse activo');

    // Add AOS attributes to visible elements
    setTimeout(() => {
      const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
      headings.forEach((el, i) => {
        if (!el.hasAttribute('data-aos')) {
          el.setAttribute('data-aos', 'fade-up');
          el.setAttribute('data-aos-delay', (i * 100).toString());
        }
      });

      const cards = document.querySelectorAll('[class*="card"], [class*="box"], [class*="item"]');
      cards.forEach((el, i) => {
        if (!el.classList.contains('voice-widget') && !el.hasAttribute('data-aos')) {
          const animation = i % 3 === 0 ? 'fade-left' : i % 3 === 1 ? 'fade-right' : 'fade-up';
          el.setAttribute('data-aos', animation);
          el.setAttribute('data-aos-delay', ((i % 10) * 100).toString());
        }
      });

      if (typeof AOS !== 'undefined') {
        AOS.refresh();
      }

      console.log('‚úÖ Atributos AOS agregados a elementos');
      console.log(`   - ${headings.length} headings`);
      console.log(`   - ${cards.length} cards/boxes/items`);
    }, 500);

    // Smooth Scroll for Links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        const href = this.getAttribute('href');
        if (href && href !== '#') {
          const target = document.querySelector(href);
          if (target) {
            e.preventDefault();
            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        }
      });
    });
    console.log('‚úÖ Smooth scroll activo');

    console.log('üéâ Todos los efectos activados!');
  });
</script>
